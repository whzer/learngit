-- 企业进出口纳税额
select ifnull( IFNULL(SUM(b.REAL_DUTY),0) + IFNULL(SUM(b.REAL_TAX),0) + IFNULL(SUM(b.REAL_REG),0) +IFNULL( SUM(b.REAL_ANTI),0),0) as totalTax,date_format(tb.D_DATE,'%Y-%m') as yearAndMonth from ( SELECT f.TRADE_CO, f.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel f GROUP BY f.TRADE_CO, f.SOCIAL_CREDIT_CODE) c left join (select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_entry_head union all select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_external_entry_head) tb on c.TRADE_CO=tb.TRADE_CO left join (select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.entry_list union all select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.external_entry_list) b on tb.ENTRY_ID = b.ENTRY_ID where c.SOCIAL_CREDIT_CODE= ? and (tb.TRADE_CO like '4403%' or tb.TRADE_CO like '4413%' or tb.TRADE_CO like '4453%') and date_format(tb.D_DATE,'%Y') between ? and ? group by date_format(tb.D_DATE,'%Y-%m') 
 Parameters: 123456789(String), 2019(String), 2020(String)
-- 企业减免税金额

select ifnull( IFNULL(SUM(b.DUTY_CUT),0)+ IFNULL(SUM(b.TAX_CUT),0)+ IFNULL(SUM(b.REG_CUT),0)+ IFNULL(SUM(b.ANTI_CUT),0),0) as reducingTax,date_format(tb.D_DATE,'%Y-%m') as yearAndMonth from ( SELECT f.TRADE_CO, f.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel f GROUP BY f.TRADE_CO, f.SOCIAL_CREDIT_CODE) c left join (select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_entry_head union all select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_external_entry_head) tb on c.TRADE_CO=tb.TRADE_CO left join (select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.entry_list union all select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.external_entry_list) b on tb.ENTRY_ID = b.ENTRY_ID where c.SOCIAL_CREDIT_CODE= ? and (tb.TRADE_CO like '4403%' or tb.TRADE_CO like '4413%' or tb.TRADE_CO like '4453%') and date_format(tb.D_DATE,'%Y') between ? and ? group by date_format(tb.D_DATE,'%Y-%m') 
Parameters: 123456789(String), 2019(String), 2020(String)
-- 企业进出口税额和减免税额分页查询
select c.TRADE_CO as code,c.FULL_NAME as name, ifnull(sum(IFNULL(b.REAL_DUTY,0)+IFNULL(b.REAL_TAX,0)+IFNULL(b.REAL_REG,0)+IFNULL(b.REAL_ANTI,0)),0) as totalTax, ifnull(sum(IFNULL(b.DUTY_CUT,0)+IFNULL(b.TAX_CUT,0)+IFNULL(b.REG_CUT,0)+IFNULL(b.ANTI_CUT,0)),0) as cutTax, ifnull(sum(if(tb.I_E_FLAG='I',IFNULL(b.REAL_DUTY,0)+IFNULL(b.REAL_TAX,0)+IFNULL(b.REAL_REG,0)+IFNULL(b.REAL_ANTI,0),0)),0) as importTax, ifnull(sum(if(tb.I_E_FLAG='E',IFNULL(b.REAL_DUTY,0)+IFNULL(b.REAL_TAX,0)+IFNULL(b.REAL_REG,0)+IFNULL(b.REAL_ANTI,0),0)),0) as exportTax, date_format(tb.D_DATE,'%Y%m') as yearAndMonth from ( SELECT f.TRADE_CO, f.SOCIAL_CREDIT_CODE, f.FULL_NAME FROM riskh2000_extr.company_rel f GROUP BY f.TRADE_CO, f.SOCIAL_CREDIT_CODE, f.FULL_NAME) c left join (select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_entry_head union all select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_external_entry_head) tb on c.TRADE_CO=tb.TRADE_CO left join (select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.entry_list union all select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.external_entry_list) b on tb.ENTRY_ID = b.ENTRY_ID where c.SOCIAL_CREDIT_CODE= ? and (tb.TRADE_CO like '4403%' or tb.TRADE_CO like '4413%' or tb.TRADE_CO like '4453%') group by date_format(tb.D_DATE,'%Y%m'),c.TRADE_CO,c.FULL_NAME,c.SOCIAL_CREDIT_CODE order by date_format(tb.D_DATE,'%Y%m'),c.TRADE_CO desc LIMIT 0,10 
Parameters: 123456789(String)
-- 企业未缴税额情况详情
select tb.ENTRY_ID as id, c.TAX_TYPE as taxType, c.TAX_ID as taxId, c.DUTY_FLAG as dutyFlag, c.P_LIMIT as pLimit, c.DELAY_MARK as delayMark, c.REAL_TAX as realTax, c.C_DATE as cDate, c.ENTRY_ID as entryID from (SELECT f.TRADE_CO, f.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel f GROUP BY f.TRADE_CO, f.SOCIAL_CREDIT_CODE) a left join app_wsjc.od_ch_dutyform_head tb on a.TRADE_CO=tb.TRADE_CODE left join riskh2000_extr.dutyform_list c on tb.ENTRY_ID=c.ENTRY_ID where a.SOCIAL_CREDIT_CODE= ? and (tb.TRADE_CODE like '4403%' or tb.TRADE_CODE like '4413%' or tb.TRADE_CODE like '4453%') and (c.C_DATE is null and c.P_LIMIT<now()) order by c.P_LIMIT,id desc LIMIT 0,10 
 Parameters: 123456789(String)
-- 企业未缴税额情况        未缴欠税总额：
 select ifnull(sum(c.REAL_TAX),0) as tax from ( SELECT f.TRADE_CO, f.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel f GROUP BY f.TRADE_CO, f.SOCIAL_CREDIT_CODE) a left join app_wsjc.od_ch_dutyform_head tb on a.TRADE_CO=tb.TRADE_CODE left join riskh2000_extr.dutyform_list c on tb.ENTRY_ID=c.ENTRY_ID where a.SOCIAL_CREDIT_CODE= ? and (tb.TRADE_CODE like '4403%' or tb.TRADE_CODE like '4413%' or tb.TRADE_CODE like '4453%') and date_format(c.P_LIMIT,'%Y') between ? and ? and (c.C_DATE is null and c.P_LIMIT<now()) 
 Parameters: 123456789(String), 2020(Integer), 2020(Integer)
--企业未缴滞纳金情况详情
 select tb.ENTRY_ID as id, c.TAX_TYPE as taxType, c.TAX_ID as taxId, c.DUTY_FLAG as dutyFlag, c.P_LIMIT as pLimit,c.DELAY_MARK as delayMark,c.REAL_TAX as realTax,c.C_DATE as cDate,c.ENTRY_ID as entryID,(c.C_DATE - c.P_LIMIT) as alreadyDate from ( SELECT c.TRADE_CO, c.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel c GROUP BY c.TRADE_CO, c.SOCIAL_CREDIT_CODE) a left join app_wsjc.od_ch_dutyform_head tb on a.TRADE_CO=tb.TRADE_CODE left join riskh2000_extr.dutyform_list c on tb.ENTRY_ID=c.ENTRY_ID where a.SOCIAL_CREDIT_CODE= ? and (tb.TRADE_CODE like '4403%' or tb.TRADE_CODE like '4413%' or tb.TRADE_CODE like '4453%') and c.DELAY_MARK='1' and (c.C_DATE is null and c.P_LIMIT<now()) order by c.P_LIMIT desc LIMIT 0,10 
 Parameters: 123456789(String)
-- 企业未缴滞纳金情况        未缴滞纳金总额
select ifnull(sum(c.REAL_TAX),0) as tax from ( SELECT  c.TRADE_CO, c.SOCIAL_CREDIT_CODE  from riskh2000_extr.company_rel c GROUP BY c.TRADE_CO, c.SOCIAL_CREDIT_CODE) a left join app_wsjc.od_ch_dutyform_head tb on a.TRADE_CO=tb.TRADE_CODE left join riskh2000_extr.dutyform_list c on tb.ENTRY_ID=c.ENTRY_ID where a.SOCIAL_CREDIT_CODE= ? and (tb.TRADE_CODE like '4403%' or tb.TRADE_CODE like '4413%' or tb.TRADE_CODE like '4453%') and c.DELAY_MARK='1' and date_format(c.P_LIMIT,'%Y') between ? and ? and (c.C_DATE is null and c.P_LIMIT<now()) 
 Parameters: 123456789(String), 2020(Integer), 2020(Integer)
 -- 征税要素修改提示列表
 SELECT COUNT(1) FROM (SELECT c.TRADE_CO, c.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel c GROUP BY c.TRADE_CO, c.SOCIAL_CREDIT_CODE) a JOIN (SELECT entry_id, I_E_FLAG, D_DATE, TRADE_CO, TRADE_MODE, EDI_REMARK FROM app_wsjc.od_ch_entry_head UNION ALL SELECT entry_id, I_E_FLAG, D_DATE, TRADE_CO, TRADE_MODE, EDI_REMARK FROM app_wsjc.od_ch_external_entry_head) tb ON a.TRADE_CO = tb.TRADE_CO JOIN riskh2000_extr.entry_modi_log c ON tb.ENTRY_ID = c.ENTRY_ID WHERE a.SOCIAL_CREDIT_CODE = ? AND (tb.TRADE_CO LIKE '4403%' OR tb.TRADE_CO LIKE '4413%' OR tb.TRADE_CO LIKE '4453%') 
 Parameters: 123456789(String)
 --企业补税额情况
 select tb.ENTRY_ID as id,c.TAX_TYPE as taxType,c.TAX_ID as taxId, c.DUTY_FLAG as dutyFlag,c.REAL_TAX as realTax,c.C_DATE as cDate from ( SELECT c.TRADE_CO, c.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel c GROUP BY c.TRADE_CO, c.SOCIAL_CREDIT_CODE) a left join app_wsjc.od_ch_dutyform_head tb on a.TRADE_CO=tb.TRADE_CODE left join riskh2000_extr.dutyform_list c on tb.ENTRY_ID=c.ENTRY_ID where a.SOCIAL_CREDIT_CODE=? and c.DUTY_FLAG='/' and (tb.TRADE_CODE like '4403%' or tb.TRADE_CODE like '4413%' or tb.TRADE_CODE like '4453%') order by c.C_DATE,id desc LIMIT 0,10 
Parameters: 123456789(String)
 -- 企业补税额情况列表    企业补税总额：
 select ifnull(sum(c.REAL_TAX),0) as tax from  ( SELECT f.TRADE_CO, f.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel f GROUP BY f.TRADE_CO, f.SOCIAL_CREDIT_CODE) a left join app_wsjc.od_ch_dutyform_head tb on a.TRADE_CO=tb.TRADE_CODE left join riskh2000_extr.dutyform_list c on tb.ENTRY_ID=c.ENTRY_ID where a.SOCIAL_CREDIT_CODE= ? and c.DUTY_FLAG='/' and (tb.TRADE_CODE like '4403%' or tb.TRADE_CODE like '4413%' or tb.TRADE_CODE like '4453%') and date_format(c.C_DATE,'%Y') between ? and ? 
 Parameters: 123456789(String), 2020(Integer), 2020(Integer)
 --企业应税单证汇总征税率
 select count(distinct tb.ENTRY_ID) as nums,IFNULL(IFNULL(SUM(c.REAL_DUTY),0) + IFNULL(SUM(c.REAL_TAX),0) + IFNULL(SUM(c.REAL_REG),0) +IFNULL( SUM(c.REAL_ANTI),0),0) as totalTax, date_format(tb.D_DATE,'%Y-%m') as yearAndMonth from (SELECT c.TRADE_CO, c.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel c GROUP BY c.TRADE_CO, c.SOCIAL_CREDIT_CODE) a left join (select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_entry_head union all select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_external_entry_head) as tb on a.TRADE_CO=tb.TRADE_CO left join (select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.entry_list union all select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.external_entry_list) c on tb.ENTRY_ID=c.ENTRY_ID where a.SOCIAL_CREDIT_CODE= ? and substring(tb.EDI_REMARK,16,1)='3' and (tb.TRADE_CO like '4403%' or tb.TRADE_CO like '4413%' or tb.TRADE_CO like '4453%') and date_format(tb.D_DATE,'%Y') between ? and ? group by date_format(tb.D_DATE,'%Y-%m') 
 Parameters: 123456789(String), 2020(Integer), 2020(Integer)
 
  select count(distinct tb.ENTRY_ID) as nums,ifnull(sum(c.tax),0) as totalTax,date_format(tb.D_DATE,'%Y-%m') as yearAndMonth from (SELECT c.TRADE_CO, c.SOCIAL_CREDIT_CODE FROM (SELECT c.TRADE_CO, c.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel c GROUP BY c.TRADE_CO, c.SOCIAL_CREDIT_CODE) c GROUP BY c.TRADE_CO, c.SOCIAL_CREDIT_CODE) a left join (select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_entry_head union all select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_external_entry_head) tb on a.TRADE_CO=tb.TRADE_CO join (select c.ENTRY_ID,ifnull(sum(IFNULL(c.REAL_DUTY,0)+IFNULL(c.REAL_TAX,0)+IFNULL(c.REAL_REG,0)+IFNULL(c.REAL_ANTI,0)),0) as tax from (select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.entry_list union all select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.external_entry_list) c group by c.ENTRY_ID having sum(IFNULL(c.REAL_DUTY,0)+IFNULL(c.REAL_TAX,0)+IFNULL(c.REAL_REG,0)+IFNULL(c.REAL_ANTI,0))>0 or (sum(IFNULL(c.REAL_DUTY,0)+IFNULL(c.REAL_TAX,0)+IFNULL(c.REAL_REG,0)+IFNULL(c.REAL_ANTI,0))=0 and count(if(c.DUTY_MODE !=1,true,null)) = 0) )c on tb.ENTRY_ID=c.ENTRY_ID where a.SOCIAL_CREDIT_CODE= ? and (tb.TRADE_CO like '4403%' or tb.TRADE_CO like '4413%' or tb.TRADE_CO like '4453%') and date_format(tb.D_DATE,'%Y') between ? and ? group by date_format(tb.D_DATE,'%Y-%m') 
 Parameters: 123456789(String), 2020(Integer), 2020(Integer)
 -- 企业应税单证电子支付情况
 select count(*) as nums, ifnull(sum(c.REAL_TAX),0) as tax, date_format(c.C_DATE, '%Y-%m') as yearAndMonth from (SELECT c.TRADE_CO, c.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel c GROUP BY c.TRADE_CO, c.SOCIAL_CREDIT_CODE) a left join app_wsjc.od_ch_dutyform_head tb on a.TRADE_CO = tb.TRADE_CODE left join riskh2000_extr.dutyform_list c on tb.ENTRY_ID = c.ENTRY_ID where a.SOCIAL_CREDIT_CODE = ? and (tb.TRADE_CODE like '4403%' or tb.TRADE_CODE like '4413%' or tb.TRADE_CODE like '4453%') and date_format(c.C_DATE, '%Y') between ? and ? and c.PAY_MODE = '8' and tb.DUTYFORM_FLAG != 'M' and c.DUTY_FLAG not in ('#', 'D') and c.TAX_TYPE not in ('U', 'W', 'X', 'Z', 'M') group by date_format(c.C_DATE, '%Y-%m') 
 Parameters: 123456789(String), 2020(Integer), 2020(Integer)
 
 select count(*) as totalNum, ifnull(sum(c.REAL_TAX),0) as tax, date_format(c.C_DATE, '%Y-%m') as yearAndMonth from (SELECT c.TRADE_CO, c.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel c GROUP BY c.TRADE_CO, c.SOCIAL_CREDIT_CODE) a left join app_wsjc.od_ch_dutyform_head tb on a.TRADE_CO = tb.TRADE_CODE left join riskh2000_extr.dutyform_list c on tb.ENTRY_ID = c.ENTRY_ID where a.SOCIAL_CREDIT_CODE = ? and (tb.TRADE_CODE like '4403%' or tb.TRADE_CODE like '4413%' or tb.TRADE_CODE like '4453%') and date_format(c.C_DATE, '%Y') between ? and ? group by date_format(c.C_DATE, '%Y-%m') 
 Parameters: 123456789(String), 2020(Integer), 2020(Integer)
 
 select count(*) as totalNum, ifnull(sum(c.REAL_TAX),0) as tax, date_format(c.C_DATE, '%Y-%m') as yearAndMonth from (SELECT c.TRADE_CO, c.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel c GROUP BY c.TRADE_CO, c.SOCIAL_CREDIT_CODE) a left join app_wsjc.od_ch_dutyform_head tb on a.TRADE_CO = tb.TRADE_CODE left join riskh2000_extr.dutyform_list c on tb.ENTRY_ID = c.ENTRY_ID where a.SOCIAL_CREDIT_CODE = ? and (tb.TRADE_CODE like '4403%' or tb.TRADE_CODE like '4413%' or tb.TRADE_CODE like '4453%') and date_format(c.C_DATE, '%Y') between ? and ? and (tb.DUTYFORM_FLAG = 'M' or c.DUTY_FLAG in ('#', 'D') or c.TAX_TYPE in ('U', 'W', 'X', 'Z', 'M')) group by date_format(c.C_DATE, '%Y-%m') 
 Parameters: 123456789(String), 2020(Integer), 2020(Integer)
 -- 企业进口不作价设备列表    不作价设备数量：个    不作价设备金额:
 select ifnull(sum(b.QTY_1),0) as nums,ifnull(sum(b.RMB_PRICE),0) as tax from riskh2000_extr.company_rel c left join (select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_entry_head union all select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_external_entry_head) tb on c.TRADE_CO=tb.TRADE_CO left join (select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.entry_list union all select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.external_entry_list) b on tb.ENTRY_ID=b.ENTRY_ID where c.SOCIAL_CREDIT_CODE= ? and tb.TRADE_MODE = '0320' and (tb.TRADE_CO like '4403%' or tb.TRADE_CO like '4413%' or tb.TRADE_CO like '4453%') and date_format(tb.D_DATE,'%Y') between ? and ? 
  Parameters: 123456789(String), 2020(Integer), 2020(Integer)
 --企业进口不作价设备详情
select a.ENTRY_ID as id,a.CODE_TS as codeTs,a.G_NAME as gName,a.RMB_PRICE as rmbPrice,a.QTY_1 as qty1,a.UNIT_1 as unit1, (IFNULL(a.REAL_DUTY,0)+IFNULL(a.REAL_TAX,0)+IFNULL(a.REAL_REG,0)+IFNULL(a.REAL_ANTI,0)) as taxPrice, tb.D_DATE as dDate,tb.TRADE_MODE as tradeMode from (select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.entry_list union all select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.external_entry_list) a right join (select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_entry_head union all select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_external_entry_head) tb on a.ENTRY_ID=tb.ENTRY_ID right join (SELECT c.TRADE_CO, c.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel c GROUP BY c.TRADE_CO, c.SOCIAL_CREDIT_CODE) c on c.TRADE_CO=tb.TRADE_CO where c.SOCIAL_CREDIT_CODE=? and tb.TRADE_MODE = '0320' and (tb.TRADE_CO like '4403%' or tb.TRADE_CO like '4413%' or tb.TRADE_CO like '4453%') order by tb.D_DATE,a.ENTRY_ID desc 
Parameters: 123456789(String)
-- 加工贸易内销征税分析及预警    企业加工贸易内销征税分析
select count(if(tb.TRADE_MODE = '0245', true, null)) as num0245, count(if(tb.TRADE_MODE = '0446', true, null)) as num0446, count(if(tb.TRADE_MODE = '0644', true, null)) as num0644, count(if(tb.TRADE_MODE = '0844', true, null)) as num0844, count(if(tb.TRADE_MODE = '0845', true, null)) as num0845 from (SELECT c.TRADE_CO, c.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel c GROUP BY c.TRADE_CO, c.SOCIAL_CREDIT_CODE) a left join (select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_entry_head union all select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_external_entry_head) tb on a.TRADE_CO =tb.TRADE_CO where a.SOCIAL_CREDIT_CODE = ? and date_format(tb.D_DATE,'%Y%m') between ? and ? and (tb.TRADE_CO like '4403%' or tb.TRADE_CO like '4413%' or tb.TRADE_CO like '4453%') 
Parameters: 123456789(String), 202001(Integer), 202012(Integer)
-- 加工贸易内销征税分析及预警   企业加工贸易内销征税商品分析
select sum(if(REAL_DUTY is null,0,REAL_DUTY)) as totalTax ,min(c.G_NAME) as gname from (SELECT c.TRADE_CO, c.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel c GROUP BY c.TRADE_CO, c.SOCIAL_CREDIT_CODE) a join (select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_entry_head union all select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_external_entry_head) tb on a.TRADE_CO=tb.TRADE_CO left join (select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.entry_list union all select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.external_entry_list) c on tb.ENTRY_ID=c.ENTRY_ID where a.SOCIAL_CREDIT_CODE=? and date_format(tb.D_DATE,'%Y%m') between ? and ? and (tb.TRADE_CO like '4403%' or tb.TRADE_CO like '4413%' or tb.TRADE_CO like '4453%') group by c.CODE_TS order by sum(if(REAL_DUTY is null,0,REAL_DUTY)) DESC limit 5 
 Parameters: 123456789(String), 202001(Integer), 202012(Integer)
 -- 加工贸易内销征税分析及预警
  select tb.ENTRY_ID id,c.CODE_TS gcode,c.G_NAME gname, tb.TRADE_MODE tradeMode,c.REAL_DUTY realDuty,c.RMB_PRICE price,tb.D_DATE dDate from (SELECT c.TRADE_CO, c.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel c GROUP BY c.TRADE_CO, c.SOCIAL_CREDIT_CODE) a join (select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_entry_head union all select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_external_entry_head) tb on a.TRADE_CO=tb.TRADE_CO left join (select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.entry_list union all select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.external_entry_list) c on tb.ENTRY_ID=c.ENTRY_ID where a.SOCIAL_CREDIT_CODE=? and (tb.TRADE_CO like '4403%' or tb.TRADE_CO like '4413%' or tb.TRADE_CO like '4453%') order by c.REAL_DUTY,tb.ENTRY_ID DESC LIMIT 0,10 
Parameters: 123456789(String)
-- 进口/出口申报记录
select sum(if(tb.I_E_FLAG='I',c.RMB_PRICE,0)) as importTax, sum(if(tb.I_E_FLAG='E',c.RMB_PRICE,0)) as exportTax, count(distinct if(tb.I_E_FLAG='I',tb.ENTRY_ID,null)) as importNum, count(distinct if(tb.I_E_FLAG='E',tb.ENTRY_ID,null)) as exportNum, date_format(tb.D_DATE,'%Y%m') as yearAndMonth from  ( SELECT f.TRADE_CO, f.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel f GROUP BY f.TRADE_CO, f.SOCIAL_CREDIT_CODE) a join (select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_entry_head union all select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_external_entry_head) tb on a.TRADE_CO=tb.TRADE_CO left join (select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.entry_list union all select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.external_entry_list) c on tb.ENTRY_ID=c.ENTRY_ID where a.SOCIAL_CREDIT_CODE=? and (tb.TRADE_CO like '4403%' or tb.TRADE_CO like '4413%' or tb.TRADE_CO like '4453%') group by date_format(tb.d_date,'%Y%m') 
Parameters: 123456789(String)
-- 企业进出口申报情况
select sum(if(tb.I_E_FLAG='I',c.RMB_PRICE,0)) as importTax, sum(if(tb.I_E_FLAG='E',c.RMB_PRICE,0)) as exportTax, date_format(tb.D_DATE,'%Y-%m') as yearAndMonth from  ( SELECT f.TRADE_CO, f.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel f GROUP BY f.TRADE_CO, f.SOCIAL_CREDIT_CODE) a join (select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_entry_head union all select entry_id,I_E_FLAG,D_DATE,TRADE_CO,TRADE_MODE,EDI_REMARK from app_wsjc.od_ch_external_entry_head) tb on a.TRADE_CO=tb.TRADE_CO left join (select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.entry_list union all select ENTRY_ID,G_NO,REAL_DUTY, REAL_TAX, REAL_REG, REAL_ANTI,CODE_TS,G_NAME,RMB_PRICE,ORIGIN_COUNTRY,DUTY_CUT,TAX_CUT,REG_CUT,ANTI_CUT, DUTY_MODE,QTY_1,UNIT_1 from riskh2000_extr.external_entry_list) c on tb.ENTRY_ID=c.ENTRY_ID where a.SOCIAL_CREDIT_CODE= ? and date_format(tb.D_DATE,'%Y%m') between ? and ? group by date_format(tb.D_DATE,'%Y-%m') 
Parameters: 123456789(String), 201909(Integer), 202002(Integer)

select ifnull(sum(ifnull(b.price,0) * ifnull(b.pqty,0) * ifnull(c.RMB_RATE,0)),0) as totalTax, date_format(b.purchase_dt, '%Y-%m') as yearAndMonth from app_wsjc.od_purchase_order b join riskh2000_extr.exchrate c on b.currency = c.CURR_CODE and (b.purchase_dt between c.BEGIN_DATE and c.END_DATE) left join  ( SELECT f.TRADE_CO, f.SOCIAL_CREDIT_CODE FROM riskh2000_extr.company_rel f GROUP BY f.TRADE_CO, f.SOCIAL_CREDIT_CODE) d on b.enterp_cd=d.SOCIAL_CREDIT_CODE where b.enterp_cd = ? and date_format(b.purchase_dt, '%Y%m') between ? and ? group by date_format(b.purchase_dt, '%Y-%m') 
Parameters: 123456789(String), 201909(Integer), 202002(Integer)

select ifnull(sum(ifnull(c.sales_price,0)*ifnull(c.sales_nm,0)*ifnull(d.RMB_RATE,0)),0) as totalTax,date_format(c.mkdatetime,'%Y-%m') as yearAndMonth from app_wsjc.od_delivery_order b join app_wsjc.od_sales_order c on b.sales_order_cd=c.sales_order_cd left join riskh2000_extr.exchrate d on c.currency=d.CURR_CODE and (c.mkdatetime between d.BEGIN_DATE and d.END_DATE) where b.enterp_cd= ? and date_format(c.mkdatetime,'%Y%m') between ? and ? group by date_format(c.mkdatetime,'%Y-%m'); 
Parameters: 123456789(String), 201909(Integer), 202002(Integer)
-- 企业进出口货值情况
select count(distinct b.purchase_order_cd) as nums, ifnull(sum(ifnull(b.price,0) * ifnull(b.pqty,0) * ifnull(c.RMB_RATE,0)),0) as totalTax, date_format(b.purchase_dt, '%Y-%m') as yearAndMonth from app_wsjc.od_purchase_order b left join riskh2000_extr.exchrate c on b.currency = c.CURR_CODE and (b.purchase_dt between c.BEGIN_DATE and c.END_DATE) where b.enterp_cd = ? and date_format(b.purchase_dt, '%Y') between ? and ? group by date_format(b.purchase_dt, '%Y-%m') 
Parameters: 123456789(String), 2020(Integer), 2020(Integer)

select count(distinct c.sales_order_cd) as nums,ifnull(sum(IFNULL(c.sales_price,0)*IFNULL(c.sales_nm,0)*IFNULL(d.RMB_RATE,0)),0) as totalTax,date_format(c.mkdatetime,'%Y-%m') as yearAndMonth from app_wsjc.od_delivery_order b join app_wsjc.od_sales_order c on b.sales_order_cd=c.sales_order_cd left join riskh2000_extr.exchrate d on c.currency=d.CURR_CODE and (c.mkdatetime between d.BEGIN_DATE and d.END_DATE) where b.enterp_cd= ? and date_format(c.mkdatetime,'%Y') between ? and ? group by date_format(c.mkdatetime,'%Y-%m'); 
 123456789(String), 2020(Integer), 2020(Integer)
-- 经营走势-订单量/送货单量
select b.name name, b.code code, b.yearAndMonth yearAndMonth, b.num1 purchaseNum, b.tax1 purchaseTax, b.num2 deliverNum, b.tax2 deliverTax from (select t.code as code, t.name as name, t.yearAndMonth as yearAndMonth, ifnull(sum(t.num1),0) as num1, ifnull(sum(t.tax1),0) as tax1, ifnull(sum(t.num2),0) as num2, ifnull(sum(t.tax2),0) as tax2 from ( select b.enterp_cd as code, b.enterp_nm as name, count(distinct b.purchase_order_cd) as num1, ifnull(sum(b.price * b.pqty * c.RMB_RATE),0) as tax1, 0 as num2, 0 as tax2, date_format(b.purchase_dt, '%Y%m') as yearAndMonth from app_wsjc.od_purchase_order b left join riskh2000_extr.exchrate c on b.currency = c.CURR_CODE and (b.purchase_dt between c.BEGIN_DATE and c.END_DATE) group by b.enterp_cd,b.enterp_nm, date_format(b.purchase_dt, '%Y%m') union select b.enterp_cd as code, b.enterp_nm as name, 0 as num1, 0 as tax1, count(distinct c.sales_order_cd) as num2, ifnull(sum(c.sales_price * c.sales_nm * d.RMB_RATE),0) as tax2, date_format(c.mkdatetime, '%Y%m') as yearAndMonth from app_wsjc.od_delivery_order b left join app_wsjc.od_sales_order c on b.sales_order_cd = c.sales_order_cd left join riskh2000_extr.exchrate d on c.currency = d.CURR_CODE and (c.mkdatetime between d.BEGIN_DATE and d.END_DATE) group by b.enterp_cd,b.enterp_nm, date_format(c.mkdatetime, '%Y%m') ) t group by t.code,t.name, t.yearAndMonth order by null) b where b.code = ? order by b.yearAndMonth,b.code desc 
Parameters: 123456789(String)
-- 用水用电走势
SELECT enterp_cd AS enterpCd,enterp_nm AS enterpNm,etl_month AS etlMonth,water_rate AS waterRate,electricity_rate AS electricityRate,employee_quantity AS employeeQuantity,safe_rate AS safeRate,data_business_time AS dataBusinessTime,data_update_time AS dataUpdateTime,etl_dt AS etlDt FROM app_wsjc.od_consume_energy WHERE (enterp_cd = ?) ORDER BY etl_month DESC 
Parameters: 123456789(String)
